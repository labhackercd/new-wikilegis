{% load static participations_tags %}

{% for opinion in opinions %}
<div class="card js-suggestionOpinion" data-opinion-id="{{opinion.id}}">
  <div class="header">
    <span class="votes">{{ opinion.votes.all|length }} VOTOS</span>
    <div class="consensus">
      <div class="icon">
        <span class="value" style="width: 60%;"></span>
      </div>
      <span class="info">48% consenso</span>
    </div>
  </div>
  <div class="content">
    <div class="user">
      <img src="{% if opinion.author.profile.avatar %}{{ opinion.author.profile.avatar }} {% else %} {% static 'img/avatar.png' %} {% endif %}" class="avatar" alt="Usuário">
      <span class="name">{{ opinion.author }}</span>
    </div>
    <p class="sugestion">{{ opinion.content }}</p>
  </div>
  <div class="votes">
    {% if opinion.votes.all %}
    <div class="bar -positive" style="width: 58%;">
      <span class="value">{{opinion.votes.all|count_votes:'approve'}}</span>
    </div>
    <div class="bar -neutral" style="width: 12%;">
      <span class="value">{{opinion.votes.all|count_votes:'neutral'}}</span>
    </div>
    <div class="bar -negative" style="width: 30%;">
      <span class="value">{{opinion.votes.all|count_votes:'reject'}}</span>
    </div>
    {% else %}
    <div class="bar -positive" style="width: 58%;">
      <span class="value">0</span>
    </div>
    <div class="bar -neutral" style="width: 12%;">
      <span class="value">0</span>
    </div>
    <div class="bar -negative" style="width: 30%;">
      <span class="value">0</span>
    </div>
    {% endif %}
  </div>
</div>
{% empty %}
  Sem sugestões
{% endfor %}
